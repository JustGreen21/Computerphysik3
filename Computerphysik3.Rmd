---
title: 'Übung 03: Pandemieausbruch'
author: "Tobias Blesgen und Leonardo Thome"
date: "09.06.2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
header-includes: 
 - \usepackage{amssymb}
 - \usepackage{amsmath}
 - \usepackage[ngerman]{babel}
 - \bibliographystyle{unsrtnat}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Im Folgenden wollen wir ein Simulierte Pandemieausbreitung von SARS-CoV-2 für verschiedene Parameter im SIR Modell betrachten.
Das SIR  Modell beschreibt den zeitlichen Verlauf mit folgendem Differentialgleichungssystem.
\begin{equation}
      S'(t) = -\frac{\beta}{N}S(t)I(t) -\Gamma(t)+ \delta V(t)
\end{equation}

\begin{equation}
      I'(t) = \frac{\beta}{N}S(t)I(t) -\alpha I(t)
\end{equation}

\begin{equation}
      R'(t) = \alpha I(t)
\end{equation}

\begin{equation}
      V'(t) = \Gamma(t) - \delta V(t)
\end{equation}

```{Rcpp}
#include<Rcpp.h>
#include<stdlib.h>
#include<stdio.h>

typedef struct
{
    double S, I, R, V;
} Status;

typedef struct
{
    double alpha, beta, delta, N, Gamma;
} Parameter;

void f(Status alterStatus, Parameter parameter, Status neuerStatus){
    neuerStatus.V = parameter.Gamma - parameter.delta * alterStatus.V;
    neuerStatus.R = parameter.alpha * alterStatus.I;
    neuerStatus.I = parameter.beta * alterStatus.S * alterStatus.I/parameter.N
      - parameter.alpha * alterStatus.I;
    neuerStatus.S = parameter.beta * alterStatus.S * alterStatus.I/parameter.N
      - parameter.Gamma + parameter.delta * alterStatus.V;
}

void rkStep(Status status, Parameter parameter, double h){
    Status fStatus;
    f(status, parameter, fStatus);
    Status f2Status;
    Status gemischt = {.S = status.S + h*fStatus.S, .I = status.I
      + h*fStatus.I, .R = status.R + h*fStatus.R, .V = status.V + h*fStatus.V};
    f(gemischt, parameter, f2Status);
    status.V = status.V + h/2*(fStatus.V + f2Status.V);
    status.R = status.R + h/2*(fStatus.R + f2Status.R);
    status.S = status.S + h/2*(fStatus.S + f2Status.S);
    status.I = status.I + h/2*(fStatus.I + f2Status.I);
}
```
